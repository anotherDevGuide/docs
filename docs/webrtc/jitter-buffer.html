<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jitter Buffer &mdash; WebRTC Docs</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../css/style.css">
  <style>
    /* Diagram styles */
    .diagram {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 24px;
      margin: 24px 0;
      overflow-x: auto;
    }
    .diagram svg {
      display: block;
      margin: 0 auto;
      max-width: 100%;
      height: auto;
    }
    .diagram-caption {
      text-align: center;
      font-size: 0.85rem;
      color: var(--text-muted);
      margin-top: 16px;
      font-style: italic;
    }
    .scenario-box {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 24px;
      margin: 24px 0;
    }
    .scenario-box h4 {
      color: var(--accent);
      margin-bottom: 16px;
      font-size: 1.1rem;
    }
    .stat-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
      margin: 16px 0;
    }
    .stat-card h4 {
      color: var(--accent);
      font-family: var(--font-mono);
      font-size: 0.95rem;
      margin-bottom: 8px;
    }
    .stat-card .definition {
      font-size: 1.1rem;
      color: var(--text);
      margin-bottom: 12px;
      font-weight: 500;
    }
    .stat-card .formula {
      background: var(--bg);
      padding: 12px 16px;
      border-radius: 8px;
      font-family: var(--font-mono);
      font-size: 0.85rem;
      color: var(--accent);
      margin-top: 12px;
    }
    .network-scenario {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 24px 0;
    }
    @media (max-width: 700px) {
      .network-scenario {
        grid-template-columns: 1fr;
      }
    }
    .network-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
    }
    .network-card h4 {
      font-size: 1rem;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .network-card .indicator {
      width: 12px;
      height: 12px;
      border-radius: 50%;
    }
    .network-card .indicator.good { background: #4ade80; }
    .network-card .indicator.moderate { background: #fbbf24; }
    .network-card .indicator.bad { background: #f87171; }
    .network-card .indicator.terrible { background: #ef4444; }
    .stats-table {
      width: 100%;
      font-size: 0.85rem;
      margin-top: 12px;
    }
    .stats-table td {
      padding: 6px 0;
      border: none;
    }
    .stats-table td:first-child {
      color: var(--text-muted);
    }
    .stats-table td:last-child {
      text-align: right;
      font-family: var(--font-mono);
      color: var(--accent);
    }
    .key-point {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 16px;
      background: var(--accent-dim);
      border-radius: var(--radius);
      margin: 16px 0;
    }
    .key-point-icon {
      font-size: 1.2rem;
      line-height: 1;
    }
    .key-point p {
      margin: 0;
      color: var(--text);
    }
  </style>
</head>
<body>

  <div class="container">
    <header class="doc-header">
      <a href="index.html">&larr; Back to all docs</a>
      <h1>Jitter Buffer</h1>
      <p class="subtitle">RTCInboundRtpStreamStats &mdash; audio only</p>
    </header>

    <article class="doc-content">

      <!-- ============================================ -->
      <!-- SECTION: What is Jitter Buffer -->
      <!-- ============================================ -->
      <h2>What is Jitter Buffer?</h2>
      
      <div class="key-point">
        <span class="key-point-icon">&#128161;</span>
        <p><strong>One-line answer:</strong> A temporary storage that holds incoming audio packets and releases them at steady intervals, smoothing out network timing variations.</p>
      </div>

      <!-- DIAGRAM: The Problem -->
      <div class="diagram">
        <svg viewBox="0 0 800 200" xmlns="http://www.w3.org/2000/svg">
          <!-- Title -->
          <text x="400" y="25" text-anchor="middle" fill="#e1e4ed" font-size="14" font-weight="600">The Problem: Packets Arrive at Irregular Times</text>
          
          <!-- Timeline -->
          <line x1="50" y1="100" x2="750" y2="100" stroke="#2e3345" stroke-width="2"/>
          
          <!-- Time markers -->
          <text x="50" y="130" fill="#8b90a0" font-size="11">0ms</text>
          <text x="190" y="130" fill="#8b90a0" font-size="11">20ms</text>
          <text x="330" y="130" fill="#8b90a0" font-size="11">40ms</text>
          <text x="470" y="130" fill="#8b90a0" font-size="11">60ms</text>
          <text x="610" y="130" fill="#8b90a0" font-size="11">80ms</text>
          <text x="750" y="130" fill="#8b90a0" font-size="11">100ms</text>
          
          <!-- Expected arrival (green dashed) -->
          <circle cx="50" cy="60" r="8" fill="none" stroke="#4ade80" stroke-width="2" stroke-dasharray="3,2"/>
          <circle cx="190" cy="60" r="8" fill="none" stroke="#4ade80" stroke-width="2" stroke-dasharray="3,2"/>
          <circle cx="330" cy="60" r="8" fill="none" stroke="#4ade80" stroke-width="2" stroke-dasharray="3,2"/>
          <circle cx="470" cy="60" r="8" fill="none" stroke="#4ade80" stroke-width="2" stroke-dasharray="3,2"/>
          <circle cx="610" cy="60" r="8" fill="none" stroke="#4ade80" stroke-width="2" stroke-dasharray="3,2"/>
          
          <!-- Actual arrival (solid orange) - irregular -->
          <circle cx="50" cy="60" r="8" fill="#6c9cfc"/>
          <text x="50" y="45" text-anchor="middle" fill="#6c9cfc" font-size="10">P1</text>
          
          <circle cx="210" cy="60" r="8" fill="#fbbf24"/>
          <text x="210" y="45" text-anchor="middle" fill="#fbbf24" font-size="10">P2 late</text>
          
          <circle cx="300" cy="60" r="8" fill="#fbbf24"/>
          <text x="300" y="45" text-anchor="middle" fill="#fbbf24" font-size="10">P3 early</text>
          
          <circle cx="520" cy="60" r="8" fill="#f87171"/>
          <text x="520" y="45" text-anchor="middle" fill="#f87171" font-size="10">P4 very late</text>
          
          <circle cx="600" cy="60" r="8" fill="#fbbf24"/>
          <text x="600" y="45" text-anchor="middle" fill="#fbbf24" font-size="10">P5 early</text>
          
          <!-- Legend -->
          <circle cx="100" cy="170" r="6" fill="none" stroke="#4ade80" stroke-width="2" stroke-dasharray="3,2"/>
          <text x="115" y="174" fill="#8b90a0" font-size="11">Expected (every 20ms)</text>
          
          <circle cx="300" cy="170" r="6" fill="#fbbf24"/>
          <text x="315" y="174" fill="#8b90a0" font-size="11">Actual arrival</text>
          
          <text x="480" y="174" fill="#f87171" font-size="11">This variation = JITTER</text>
        </svg>
        <p class="diagram-caption">Network jitter causes packets to arrive at unpredictable times</p>
      </div>

      <!-- DIAGRAM: The Solution -->
      <div class="diagram">
        <svg viewBox="0 0 850 380" xmlns="http://www.w3.org/2000/svg">
          <!-- Title -->
          <text x="425" y="25" text-anchor="middle" fill="#e1e4ed" font-size="14" font-weight="600">The Solution: Jitter Buffer Smooths Playback</text>
          
          <!-- Network side -->
          <text x="80" y="60" text-anchor="middle" fill="#8b90a0" font-size="12">NETWORK</text>
          <text x="80" y="75" text-anchor="middle" fill="#8b90a0" font-size="10">(chaotic)</text>
          
          <!-- Incoming packets (irregular) -->
          <rect x="30" y="90" width="28" height="22" rx="4" fill="#fbbf24"/>
          <text x="44" y="105" text-anchor="middle" fill="#0f1117" font-size="9" font-weight="600">P3</text>
          
          <rect x="65" y="90" width="28" height="22" rx="4" fill="#6c9cfc"/>
          <text x="79" y="105" text-anchor="middle" fill="#0f1117" font-size="9" font-weight="600">P1</text>
          
          <rect x="100" y="90" width="28" height="22" rx="4" fill="#f87171"/>
          <text x="114" y="105" text-anchor="middle" fill="#0f1117" font-size="9" font-weight="600">P5</text>
          
          <rect x="48" y="118" width="28" height="22" rx="4" fill="#4ade80"/>
          <text x="62" y="133" text-anchor="middle" fill="#0f1117" font-size="9" font-weight="600">P2</text>
          
          <rect x="83" y="118" width="28" height="22" rx="4" fill="#a78bfa"/>
          <text x="97" y="133" text-anchor="middle" fill="#0f1117" font-size="9" font-weight="600">P4</text>
          
          <!-- Arrow into buffer -->
          <path d="M135 110 L175 110" stroke="#6c9cfc" stroke-width="2" marker-end="url(#arrowhead)"/>
          
          <!-- Jitter Buffer Box -->
          <rect x="185" y="70" width="180" height="90" rx="12" fill="#1a1d27" stroke="#6c9cfc" stroke-width="2"/>
          <text x="275" y="95" text-anchor="middle" fill="#6c9cfc" font-size="12" font-weight="600">JITTER BUFFER</text>
          
          <!-- Packets inside buffer (ordered) -->
          <rect x="200" y="110" width="26" height="20" rx="3" fill="#6c9cfc"/>
          <text x="213" y="124" text-anchor="middle" fill="#0f1117" font-size="8" font-weight="600">P1</text>
          
          <rect x="230" y="110" width="26" height="20" rx="3" fill="#4ade80"/>
          <text x="243" y="124" text-anchor="middle" fill="#0f1117" font-size="8" font-weight="600">P2</text>
          
          <rect x="260" y="110" width="26" height="20" rx="3" fill="#fbbf24"/>
          <text x="273" y="124" text-anchor="middle" fill="#0f1117" font-size="8" font-weight="600">P3</text>
          
          <rect x="290" y="110" width="26" height="20" rx="3" fill="#a78bfa"/>
          <text x="303" y="124" text-anchor="middle" fill="#0f1117" font-size="8" font-weight="600">P4</text>
          
          <rect x="320" y="110" width="26" height="20" rx="3" fill="#f87171"/>
          <text x="333" y="124" text-anchor="middle" fill="#0f1117" font-size="8" font-weight="600">P5</text>
          
          <text x="275" y="148" text-anchor="middle" fill="#8b90a0" font-size="9">Reordered</text>
          
          <!-- Arrow out of buffer with batches -->
          <path d="M370 110 L420 110" stroke="#4ade80" stroke-width="2" marker-end="url(#arrowhead2)"/>
          <text x="395" y="100" text-anchor="middle" fill="#4ade80" font-size="8">10ms</text>
          
          <!-- Batch 1 -->
          <rect x="430" y="85" width="70" height="50" rx="6" fill="#242836" stroke="#4ade80" stroke-width="1"/>
          <text x="465" y="100" text-anchor="middle" fill="#4ade80" font-size="8" font-weight="500">Batch 1</text>
          <rect x="440" y="108" width="22" height="18" rx="2" fill="#6c9cfc"/>
          <text x="451" y="120" text-anchor="middle" fill="#0f1117" font-size="7" font-weight="600">P1</text>
          <rect x="468" y="108" width="22" height="18" rx="2" fill="#4ade80"/>
          <text x="479" y="120" text-anchor="middle" fill="#0f1117" font-size="7" font-weight="600">P2</text>
          
          <!-- Arrow between batches -->
          <path d="M505 110 L525 110" stroke="#4ade80" stroke-width="2" marker-end="url(#arrowhead2)"/>
          
          <!-- Batch 2 -->
          <rect x="535" y="85" width="70" height="50" rx="6" fill="#242836" stroke="#4ade80" stroke-width="1"/>
          <text x="570" y="100" text-anchor="middle" fill="#4ade80" font-size="8" font-weight="500">Batch 2</text>
          <rect x="545" y="108" width="22" height="18" rx="2" fill="#fbbf24"/>
          <text x="556" y="120" text-anchor="middle" fill="#0f1117" font-size="7" font-weight="600">P3</text>
          <rect x="573" y="108" width="22" height="18" rx="2" fill="#a78bfa"/>
          <text x="584" y="120" text-anchor="middle" fill="#0f1117" font-size="7" font-weight="600">P4</text>
          
          <!-- Arrow to decoder -->
          <path d="M610 110 L650 110" stroke="#fbbf24" stroke-width="2" marker-end="url(#arrowhead3)"/>
          
          <!-- Decoder Box -->
          <rect x="660" y="75" width="100" height="70" rx="8" fill="#1a1d27" stroke="#fbbf24" stroke-width="2"/>
          <text x="710" y="100" text-anchor="middle" fill="#fbbf24" font-size="11" font-weight="600">DECODER</text>
          <text x="710" y="118" text-anchor="middle" fill="#8b90a0" font-size="8">Opus → PCM</text>
          <text x="710" y="135" text-anchor="middle" fill="#8b90a0" font-size="8">(decompress)</text>
          
          <!-- Arrow down from decoder -->
          <path d="M710 145 L710 185" stroke="#4ade80" stroke-width="2" marker-end="url(#arrowhead2)"/>
          
          <!-- PCM Output Label -->
          <text x="710" y="210" text-anchor="middle" fill="#4ade80" font-size="11" font-weight="600">PCM OUTPUT</text>
          <text x="710" y="225" text-anchor="middle" fill="#8b90a0" font-size="9">(raw audio wave)</text>
          
          <!-- PCM Wave visualization -->
          <rect x="550" y="240" width="320" height="80" rx="8" fill="#242836" stroke="#4ade80" stroke-width="1"/>
          
          <!-- Sound wave -->
          <path d="M570 280 Q590 250 610 280 Q630 310 650 280 Q670 250 690 280 Q710 310 730 280 Q750 250 770 280 Q790 310 810 280 Q830 250 850 280" 
                fill="none" stroke="#4ade80" stroke-width="2"/>
          
          <!-- Wave labels -->
          <text x="710" y="260" text-anchor="middle" fill="#4ade80" font-size="9">Continuous audio wave</text>
          <text x="710" y="310" text-anchor="middle" fill="#8b90a0" font-size="8">48,000 samples/second</text>
          
          <!-- Bottom explanation -->
          <rect x="175" y="340" width="500" height="35" rx="8" fill="#242836"/>
          <text x="425" y="362" text-anchor="middle" fill="#8b90a0" font-size="10">Jitter Buffer sends batches at regular intervals → Decoder outputs smooth PCM wave</text>
          
          <!-- Arrow markers -->
          <defs>
            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
              <polygon points="0 0, 10 3.5, 0 7" fill="#6c9cfc"/>
            </marker>
            <marker id="arrowhead2" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
              <polygon points="0 0, 10 3.5, 0 7" fill="#4ade80"/>
            </marker>
            <marker id="arrowhead3" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
              <polygon points="0 0, 10 3.5, 0 7" fill="#fbbf24"/>
            </marker>
          </defs>
        </svg>
        <p class="diagram-caption">Jitter Buffer sends packet batches to Decoder, which outputs continuous PCM audio wave</p>
      </div>

      <!-- ============================================ -->
      <!-- SECTION: Role of Jitter Buffer -->
      <!-- ============================================ -->
      <h2>Role of Jitter Buffer</h2>

      <div class="diagram">
        <svg viewBox="0 0 800 340" xmlns="http://www.w3.org/2000/svg">
          <!-- Title -->
          <text x="400" y="30" text-anchor="middle" fill="#e1e4ed" font-size="14" font-weight="600">Three Jobs of the Jitter Buffer</text>
          
          <!-- Job 1: Absorb Timing Variations -->
          <rect x="50" y="60" width="220" height="120" rx="12" fill="#1a1d27" stroke="#6c9cfc" stroke-width="2"/>
          <text x="160" y="90" text-anchor="middle" fill="#6c9cfc" font-size="12" font-weight="600">1. ABSORB JITTER</text>
          
          <!-- Mini diagram: wavy line to straight -->
          <path d="M80 130 Q100 110 120 130 Q140 150 160 130 Q180 110 200 130" fill="none" stroke="#f87171" stroke-width="2"/>
          <path d="M210 130 L240 130" stroke="#8b90a0" stroke-width="2" stroke-dasharray="4,2"/>
          <line x1="80" y1="160" x2="240" y2="160" stroke="#4ade80" stroke-width="2"/>
          
          <!-- Job 2: Reorder Packets -->
          <rect x="290" y="60" width="220" height="120" rx="12" fill="#1a1d27" stroke="#fbbf24" stroke-width="2"/>
          <text x="400" y="90" text-anchor="middle" fill="#fbbf24" font-size="12" font-weight="600">2. REORDER PACKETS</text>
          
          <!-- Mini diagram: scattered to ordered -->
          <text x="320" y="125" fill="#f87171" font-size="11">3</text>
          <text x="350" y="140" fill="#f87171" font-size="11">1</text>
          <text x="380" y="115" fill="#f87171" font-size="11">4</text>
          <text x="340" y="155" fill="#f87171" font-size="11">2</text>
          
          <path d="M400 135 L430 135" stroke="#8b90a0" stroke-width="2" stroke-dasharray="4,2"/>
          
          <text x="445" y="135" fill="#4ade80" font-size="11">1</text>
          <text x="460" y="135" fill="#4ade80" font-size="11">2</text>
          <text x="475" y="135" fill="#4ade80" font-size="11">3</text>
          <text x="490" y="135" fill="#4ade80" font-size="11">4</text>
          
          <!-- Job 3: Maintain Steady Output -->
          <rect x="530" y="60" width="220" height="120" rx="12" fill="#1a1d27" stroke="#4ade80" stroke-width="2"/>
          <text x="640" y="90" text-anchor="middle" fill="#4ade80" font-size="12" font-weight="600">3. STEADY OUTPUT</text>
          
          <!-- Mini diagram: clock with regular ticks -->
          <circle cx="640" cy="135" r="25" fill="none" stroke="#4ade80" stroke-width="2"/>
          <line x1="640" y1="135" x2="640" y2="118" stroke="#4ade80" stroke-width="2"/>
          <line x1="640" y1="135" x2="655" y2="140" stroke="#4ade80" stroke-width="2"/>
          <text x="640" y="175" text-anchor="middle" fill="#8b90a0" font-size="10">10ms intervals</text>
          
          <!-- Trade-off section -->
          <rect x="100" y="210" width="600" height="110" rx="12" fill="#242836" stroke="#2e3345" stroke-width="1"/>
          <text x="400" y="240" text-anchor="middle" fill="#e1e4ed" font-size="13" font-weight="600">THE TRADE-OFF</text>
          
          <!-- Scale visualization -->
          <line x1="150" y1="270" x2="650" y2="270" stroke="#2e3345" stroke-width="3"/>
          
          <circle cx="200" cy="270" r="8" fill="#f87171"/>
          <text x="200" y="255" text-anchor="middle" fill="#f87171" font-size="10">Small Buffer</text>
          <text x="200" y="290" text-anchor="middle" fill="#8b90a0" font-size="9">Low latency</text>
          <text x="200" y="302" text-anchor="middle" fill="#8b90a0" font-size="9">More glitches</text>
          
          <circle cx="400" cy="270" r="8" fill="#fbbf24"/>
          <text x="400" y="255" text-anchor="middle" fill="#fbbf24" font-size="10">Balanced</text>
          <text x="400" y="295" text-anchor="middle" fill="#8b90a0" font-size="9">Optimal</text>
          
          <circle cx="600" cy="270" r="8" fill="#4ade80"/>
          <text x="600" y="255" text-anchor="middle" fill="#4ade80" font-size="10">Large Buffer</text>
          <text x="600" y="290" text-anchor="middle" fill="#8b90a0" font-size="9">High latency</text>
          <text x="600" y="302" text-anchor="middle" fill="#8b90a0" font-size="9">Smooth audio</text>
        </svg>
        <p class="diagram-caption">The jitter buffer balances latency vs. audio quality</p>
      </div>

      <!-- The Impossible Triangle -->
      <h3>The Impossible Triangle</h3>
      <p>In real-time communication, you're always balancing three things:</p>
      
      <div class="diagram">
        <svg viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg">
          <!-- Title -->
          <text x="400" y="30" text-anchor="middle" fill="#e1e4ed" font-size="14" font-weight="600">The Impossible Triangle: Pick Any Two</text>
          
          <!-- Triangle -->
          <polygon points="400,70 200,320 600,320" fill="none" stroke="#6c9cfc" stroke-width="3"/>
          
          <!-- Center balance icon -->
          <text x="400" y="210" text-anchor="middle" fill="#fbbf24" font-size="28">⚖️</text>
          
          <!-- Top vertex: Low Latency -->
          <circle cx="400" cy="70" r="12" fill="#4ade80"/>
          <text x="400" y="55" text-anchor="middle" fill="#4ade80" font-size="13" font-weight="600">LOW LATENCY</text>
          
          <!-- Bottom left vertex: Low Packet Loss -->
          <circle cx="200" cy="320" r="12" fill="#6c9cfc"/>
          <text x="200" y="350" text-anchor="middle" fill="#6c9cfc" font-size="13" font-weight="600">LOW PACKET</text>
          <text x="200" y="368" text-anchor="middle" fill="#6c9cfc" font-size="13" font-weight="600">LOSS</text>
          
          <!-- Bottom right vertex: Smooth Audio -->
          <circle cx="600" cy="320" r="12" fill="#a78bfa"/>
          <text x="600" y="350" text-anchor="middle" fill="#a78bfa" font-size="13" font-weight="600">SMOOTH</text>
          <text x="600" y="368" text-anchor="middle" fill="#a78bfa" font-size="13" font-weight="600">AUDIO</text>
          
          <!-- Edge labels explaining trade-offs -->
          <!-- Left edge: Low Latency + Low Packet Loss = Choppy Audio -->
          <rect x="220" y="160" width="130" height="50" rx="6" fill="#1a1d27" stroke="#f87171" stroke-width="1"/>
          <text x="285" y="182" text-anchor="middle" fill="#f87171" font-size="9">Small buffer</text>
          <text x="285" y="198" text-anchor="middle" fill="#8b90a0" font-size="8">= Choppy audio</text>
          
          <!-- Right edge: Low Latency + Smooth Audio = More Loss -->
          <rect x="450" y="160" width="130" height="50" rx="6" fill="#1a1d27" stroke="#f87171" stroke-width="1"/>
          <text x="515" y="182" text-anchor="middle" fill="#f87171" font-size="9">Skip late packets</text>
          <text x="515" y="198" text-anchor="middle" fill="#8b90a0" font-size="8">= More loss</text>
          
          <!-- Bottom edge: Low Packet Loss + Smooth Audio = High Latency -->
          <rect x="335" y="280" width="130" height="50" rx="6" fill="#1a1d27" stroke="#f87171" stroke-width="1"/>
          <text x="400" y="302" text-anchor="middle" fill="#f87171" font-size="9">Large buffer</text>
          <text x="400" y="318" text-anchor="middle" fill="#8b90a0" font-size="8">= High latency</text>
        </svg>
        <p class="diagram-caption">You can optimize for any TWO, but the third will suffer</p>
      </div>

      <!-- ============================================ -->
      <!-- SECTION: Jitter Buffer Stats -->
      <!-- ============================================ -->
      <h2>Jitter Buffer Stats</h2>

      <p>All stats from <code>RTCInboundRtpStreamStats</code> (audio only):</p>

      <!-- Stat 1: jitterBufferDelay -->
      <div class="stat-card">
        <h4>jitterBufferDelay</h4>
        <p class="definition">Total time all audio samples spent waiting in the buffer.</p>
        <p>Measured in <strong>seconds</strong>. Cumulative value that keeps increasing.</p>
        <div class="formula">Average Delay = jitterBufferDelay / jitterBufferEmittedCount</div>
      </div>

      <!-- Stat 2: jitterBufferTargetDelay -->
      <div class="stat-card">
        <h4>jitterBufferTargetDelay</h4>
        <p class="definition">The delay the system is <em>trying</em> to maintain.</p>
        <p>Also cumulative. Represents the ideal buffer size the algorithm targets.</p>
        <div class="formula">Target Delay = jitterBufferTargetDelay / jitterBufferEmittedCount</div>
      </div>

      <!-- Stat 3: jitterBufferEmittedCount -->
      <div class="stat-card">
        <h4>jitterBufferEmittedCount</h4>
        <p class="definition">Number of audio samples released from the buffer.</p>
        <p>Use this to calculate averages from cumulative values above.</p>
        <div class="formula">Samples played = jitterBufferEmittedCount</div>
      </div>

      <!-- Stat 4: jitterBufferMinimumDelay -->
      <div class="stat-card">
        <h4>jitterBufferMinimumDelay</h4>
        <p class="definition">Minimum delay the buffer must maintain (floor value).</p>
        <p>Set by application or system. Buffer won't go below this.</p>
        <div class="formula">Min Delay = jitterBufferMinimumDelay / jitterBufferEmittedCount</div>
      </div>

      <!-- Visual: How stats relate -->
      <div class="diagram">
        <svg viewBox="0 0 800 250" xmlns="http://www.w3.org/2000/svg">
          <text x="400" y="25" text-anchor="middle" fill="#e1e4ed" font-size="14" font-weight="600">How Stats Relate</text>
          
          <!-- Timeline bar -->
          <rect x="100" y="80" width="600" height="40" rx="6" fill="#242836"/>
          
          <!-- Minimum delay zone -->
          <rect x="100" y="80" width="120" height="40" rx="6" fill="#f87171" fill-opacity="0.3"/>
          <text x="160" y="105" text-anchor="middle" fill="#f87171" font-size="11" font-weight="500">Minimum</text>
          
          <!-- Target delay marker -->
          <line x1="400" y1="70" x2="400" y2="130" stroke="#fbbf24" stroke-width="3"/>
          <text x="400" y="60" text-anchor="middle" fill="#fbbf24" font-size="11" font-weight="500">Target</text>
          
          <!-- Actual delay marker (can vary) -->
          <line x1="480" y1="70" x2="480" y2="130" stroke="#6c9cfc" stroke-width="3"/>
          <text x="480" y="60" text-anchor="middle" fill="#6c9cfc" font-size="11" font-weight="500">Actual</text>
          
          <!-- Labels -->
          <text x="100" y="145" fill="#8b90a0" font-size="10">0ms</text>
          <text x="700" y="145" fill="#8b90a0" font-size="10">Buffer Size</text>
          
          <!-- Explanation boxes -->
          <rect x="100" y="170" width="180" height="55" rx="8" fill="#1a1d27" stroke="#f87171" stroke-width="1"/>
          <text x="190" y="192" text-anchor="middle" fill="#f87171" font-size="10" font-weight="500">jitterBufferMinimumDelay</text>
          <text x="190" y="210" text-anchor="middle" fill="#8b90a0" font-size="9">Floor - can't go below</text>
          
          <rect x="310" y="170" width="180" height="55" rx="8" fill="#1a1d27" stroke="#fbbf24" stroke-width="1"/>
          <text x="400" y="192" text-anchor="middle" fill="#fbbf24" font-size="10" font-weight="500">jitterBufferTargetDelay</text>
          <text x="400" y="210" text-anchor="middle" fill="#8b90a0" font-size="9">Goal the system aims for</text>
          
          <rect x="520" y="170" width="180" height="55" rx="8" fill="#1a1d27" stroke="#6c9cfc" stroke-width="1"/>
          <text x="610" y="192" text-anchor="middle" fill="#6c9cfc" font-size="10" font-weight="500">jitterBufferDelay</text>
          <text x="610" y="210" text-anchor="middle" fill="#8b90a0" font-size="9">What actually happened</text>
        </svg>
        <p class="diagram-caption">Minimum ≤ Target ≤ Actual (usually)</p>
      </div>

      <!-- ============================================ -->
      <!-- SECTION: Network Scenarios -->
      <!-- ============================================ -->
      <h2>Network Scenarios</h2>

      <p>How jitter buffer behaves under different network conditions:</p>

      <!-- Scenario 1: Perfect Network -->
      <h3>Scenario 1: Perfect Network</h3>
      <div class="diagram">
        <svg viewBox="0 0 800 180" xmlns="http://www.w3.org/2000/svg">
          <text x="400" y="25" text-anchor="middle" fill="#4ade80" font-size="13" font-weight="600">Perfect Network - Low Jitter</text>
          
          <!-- Packet arrival visualization -->
          <text x="50" y="60" fill="#8b90a0" font-size="11">Packets arrive:</text>
          
          <!-- Regular spacing -->
          <rect x="150" y="45" width="35" height="25" rx="4" fill="#4ade80"/>
          <rect x="200" y="45" width="35" height="25" rx="4" fill="#4ade80"/>
          <rect x="250" y="45" width="35" height="25" rx="4" fill="#4ade80"/>
          <rect x="300" y="45" width="35" height="25" rx="4" fill="#4ade80"/>
          <rect x="350" y="45" width="35" height="25" rx="4" fill="#4ade80"/>
          <rect x="400" y="45" width="35" height="25" rx="4" fill="#4ade80"/>
          
          <text x="500" y="62" fill="#4ade80" font-size="11">Every 20ms (consistent)</text>
          
          <!-- Buffer state -->
          <text x="50" y="100" fill="#8b90a0" font-size="11">Buffer state:</text>
          <rect x="150" y="85" width="200" height="30" rx="6" fill="#242836" stroke="#2e3345"/>
          <rect x="150" y="85" width="60" height="30" rx="6" fill="#4ade80" fill-opacity="0.4"/>
          <text x="250" y="105" text-anchor="middle" fill="#8b90a0" font-size="10">Small &amp; stable</text>
          
          <!-- Stats -->
          <rect x="450" y="85" width="300" height="70" rx="8" fill="#1a1d27"/>
          <text x="470" y="108" fill="#8b90a0" font-size="10">Avg Delay:</text>
          <text x="600" y="108" fill="#4ade80" font-size="11" font-weight="500">~20-40ms</text>
          <text x="470" y="128" fill="#8b90a0" font-size="10">Target Delay:</text>
          <text x="600" y="128" fill="#4ade80" font-size="11" font-weight="500">~30ms</text>
          <text x="470" y="148" fill="#8b90a0" font-size="10">Buffer grows:</text>
          <text x="600" y="148" fill="#4ade80" font-size="11" font-weight="500">No</text>
        </svg>
      </div>

      <div class="network-scenario">
        <div class="network-card">
          <h4><span class="indicator good"></span> Network Condition</h4>
          <table class="stats-table">
            <tr><td>Jitter</td><td>&lt; 5ms</td></tr>
            <tr><td>Packet Loss</td><td>&lt; 0.1%</td></tr>
            <tr><td>Latency</td><td>Stable</td></tr>
          </table>
        </div>
        <div class="network-card">
          <h4><span class="indicator good"></span> Buffer Behavior</h4>
          <table class="stats-table">
            <tr><td>jitterBufferDelay</td><td>Low, stable</td></tr>
            <tr><td>jitterBufferTargetDelay</td><td>Minimal</td></tr>
            <tr><td>Buffer size</td><td>Small</td></tr>
          </table>
        </div>
      </div>

      <!-- Scenario 2: Moderate Jitter -->
      <h3>Scenario 2: Moderate Jitter (WiFi)</h3>
      <div class="diagram">
        <svg viewBox="0 0 800 180" xmlns="http://www.w3.org/2000/svg">
          <text x="400" y="25" text-anchor="middle" fill="#fbbf24" font-size="13" font-weight="600">WiFi Network - Variable Jitter</text>
          
          <!-- Packet arrival visualization -->
          <text x="50" y="60" fill="#8b90a0" font-size="11">Packets arrive:</text>
          
          <!-- Irregular spacing -->
          <rect x="150" y="45" width="35" height="25" rx="4" fill="#4ade80"/>
          <rect x="195" y="45" width="35" height="25" rx="4" fill="#fbbf24"/>
          <rect x="260" y="45" width="35" height="25" rx="4" fill="#fbbf24"/>
          <rect x="300" y="45" width="35" height="25" rx="4" fill="#4ade80"/>
          <rect x="370" y="45" width="35" height="25" rx="4" fill="#f87171"/>
          <rect x="410" y="45" width="35" height="25" rx="4" fill="#4ade80"/>
          
          <text x="500" y="62" fill="#fbbf24" font-size="11">15-40ms gaps (variable)</text>
          
          <!-- Buffer state -->
          <text x="50" y="100" fill="#8b90a0" font-size="11">Buffer state:</text>
          <rect x="150" y="85" width="200" height="30" rx="6" fill="#242836" stroke="#2e3345"/>
          <rect x="150" y="85" width="120" height="30" rx="6" fill="#fbbf24" fill-opacity="0.4"/>
          <text x="250" y="105" text-anchor="middle" fill="#8b90a0" font-size="10">Medium &amp; adapting</text>
          
          <!-- Stats -->
          <rect x="450" y="85" width="300" height="70" rx="8" fill="#1a1d27"/>
          <text x="470" y="108" fill="#8b90a0" font-size="10">Avg Delay:</text>
          <text x="600" y="108" fill="#fbbf24" font-size="11" font-weight="500">~50-80ms</text>
          <text x="470" y="128" fill="#8b90a0" font-size="10">Target Delay:</text>
          <text x="600" y="128" fill="#fbbf24" font-size="11" font-weight="500">~60ms</text>
          <text x="470" y="148" fill="#8b90a0" font-size="10">Buffer grows:</text>
          <text x="600" y="148" fill="#fbbf24" font-size="11" font-weight="500">Gradually</text>
        </svg>
      </div>

      <div class="network-scenario">
        <div class="network-card">
          <h4><span class="indicator moderate"></span> Network Condition</h4>
          <table class="stats-table">
            <tr><td>Jitter</td><td>10-30ms</td></tr>
            <tr><td>Packet Loss</td><td>0.5-2%</td></tr>
            <tr><td>Latency</td><td>Variable</td></tr>
          </table>
        </div>
        <div class="network-card">
          <h4><span class="indicator moderate"></span> Buffer Behavior</h4>
          <table class="stats-table">
            <tr><td>jitterBufferDelay</td><td>Increasing</td></tr>
            <tr><td>jitterBufferTargetDelay</td><td>Adapts up</td></tr>
            <tr><td>Buffer size</td><td>Growing</td></tr>
          </table>
        </div>
      </div>

      <!-- Scenario 3: High Jitter -->
      <h3>Scenario 3: High Jitter (Congested Network)</h3>
      <div class="diagram">
        <svg viewBox="0 0 800 180" xmlns="http://www.w3.org/2000/svg">
          <text x="400" y="25" text-anchor="middle" fill="#f87171" font-size="13" font-weight="600">Congested Network - High Jitter</text>
          
          <!-- Packet arrival visualization -->
          <text x="50" y="60" fill="#8b90a0" font-size="11">Packets arrive:</text>
          
          <!-- Very irregular - bursts -->
          <rect x="150" y="45" width="35" height="25" rx="4" fill="#4ade80"/>
          <rect x="190" y="40" width="35" height="25" rx="4" fill="#f87171"/>
          <rect x="195" y="50" width="35" height="25" rx="4" fill="#f87171"/>
          <rect x="320" y="45" width="35" height="25" rx="4" fill="#f87171"/>
          <rect x="325" y="40" width="35" height="25" rx="4" fill="#f87171"/>
          <rect x="330" y="55" width="35" height="25" rx="4" fill="#f87171"/>
          <rect x="450" y="45" width="35" height="25" rx="4" fill="#4ade80"/>
          
          <text x="550" y="62" fill="#f87171" font-size="11">Bursts then gaps</text>
          
          <!-- Buffer state -->
          <text x="50" y="100" fill="#8b90a0" font-size="11">Buffer state:</text>
          <rect x="150" y="85" width="200" height="30" rx="6" fill="#242836" stroke="#2e3345"/>
          <rect x="150" y="85" width="180" height="30" rx="6" fill="#f87171" fill-opacity="0.4"/>
          <text x="250" y="105" text-anchor="middle" fill="#8b90a0" font-size="10">Large &amp; fluctuating</text>
          
          <!-- Stats -->
          <rect x="450" y="85" width="300" height="70" rx="8" fill="#1a1d27"/>
          <text x="470" y="108" fill="#8b90a0" font-size="10">Avg Delay:</text>
          <text x="600" y="108" fill="#f87171" font-size="11" font-weight="500">~100-200ms</text>
          <text x="470" y="128" fill="#8b90a0" font-size="10">Target Delay:</text>
          <text x="600" y="128" fill="#f87171" font-size="11" font-weight="500">~150ms</text>
          <text x="470" y="148" fill="#8b90a0" font-size="10">Buffer grows:</text>
          <text x="600" y="148" fill="#f87171" font-size="11" font-weight="500">Rapidly</text>
        </svg>
      </div>

      <div class="network-scenario">
        <div class="network-card">
          <h4><span class="indicator bad"></span> Network Condition</h4>
          <table class="stats-table">
            <tr><td>Jitter</td><td>50-100ms+</td></tr>
            <tr><td>Packet Loss</td><td>2-5%</td></tr>
            <tr><td>Latency</td><td>Spiky</td></tr>
          </table>
        </div>
        <div class="network-card">
          <h4><span class="indicator bad"></span> Buffer Behavior</h4>
          <table class="stats-table">
            <tr><td>jitterBufferDelay</td><td>High</td></tr>
            <tr><td>jitterBufferTargetDelay</td><td>Max value</td></tr>
            <tr><td>Buffer size</td><td>Near limit</td></tr>
          </table>
        </div>
      </div>

      <!-- Scenario 4: Network Recovery -->
      <h3>Scenario 4: Network Recovery</h3>
      <div class="diagram">
        <svg viewBox="0 0 800 200" xmlns="http://www.w3.org/2000/svg">
          <text x="400" y="25" text-anchor="middle" fill="#a78bfa" font-size="13" font-weight="600">Network Improves - Buffer Drains</text>
          
          <!-- Timeline -->
          <line x1="100" y1="100" x2="700" y2="100" stroke="#2e3345" stroke-width="2"/>
          
          <!-- Phase labels -->
          <text x="200" y="60" text-anchor="middle" fill="#f87171" font-size="11">Bad Network</text>
          <text x="400" y="60" text-anchor="middle" fill="#fbbf24" font-size="11">Improving</text>
          <text x="600" y="60" text-anchor="middle" fill="#4ade80" font-size="11">Recovered</text>
          
          <!-- Buffer level visualization -->
          <path d="M100 70 L200 70 L250 75 L350 85 L450 90 L550 95 L650 98 L700 98" fill="none" stroke="#6c9cfc" stroke-width="3"/>
          
          <!-- Target line -->
          <line x1="100" y1="95" x2="700" y2="95" stroke="#fbbf24" stroke-width="2" stroke-dasharray="5,3"/>
          
          <!-- Legend -->
          <line x1="150" y1="140" x2="180" y2="140" stroke="#6c9cfc" stroke-width="3"/>
          <text x="190" y="144" fill="#8b90a0" font-size="10">Actual buffer level</text>
          
          <line x1="350" y1="140" x2="380" y2="140" stroke="#fbbf24" stroke-width="2" stroke-dasharray="5,3"/>
          <text x="390" y="144" fill="#8b90a0" font-size="10">Target level</text>
          
          <!-- Explanation -->
          <rect x="150" y="160" width="500" height="30" rx="6" fill="#242836"/>
          <text x="400" y="180" text-anchor="middle" fill="#8b90a0" font-size="11">Buffer slowly drains as network stabilizes (to reduce latency)</text>
        </svg>
      </div>

      <div class="network-scenario">
        <div class="network-card">
          <h4><span class="indicator good"></span> What Happens</h4>
          <table class="stats-table">
            <tr><td>Jitter</td><td>Decreasing</td></tr>
            <tr><td>Target delay</td><td>Lowering</td></tr>
            <tr><td>Actual delay</td><td>Catching up</td></tr>
          </table>
        </div>
        <div class="network-card">
          <h4><span class="indicator good"></span> Buffer Behavior</h4>
          <table class="stats-table">
            <tr><td>jitterBufferDelay</td><td>Decreasing</td></tr>
            <tr><td>jitterBufferTargetDelay</td><td>Lowering</td></tr>
            <tr><td>Emitted count</td><td>Steady increase</td></tr>
          </table>
        </div>
      </div>

      <!-- ============================================ -->
      <!-- SECTION: Quick Reference -->
      <!-- ============================================ -->
      <h2>Quick Reference</h2>

      <table>
        <thead>
          <tr>
            <th>Stat</th>
            <th>Type</th>
            <th>Meaning</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>jitterBufferDelay</code></td>
            <td>Cumulative (seconds)</td>
            <td>Total wait time of all samples</td>
          </tr>
          <tr>
            <td><code>jitterBufferTargetDelay</code></td>
            <td>Cumulative (seconds)</td>
            <td>Ideal delay the system targets</td>
          </tr>
          <tr>
            <td><code>jitterBufferEmittedCount</code></td>
            <td>Counter</td>
            <td>Samples released for playback</td>
          </tr>
          <tr>
            <td><code>jitterBufferMinimumDelay</code></td>
            <td>Cumulative (seconds)</td>
            <td>Minimum allowed delay (floor)</td>
          </tr>
        </tbody>
      </table>

      <div class="key-point">
        <span class="key-point-icon">&#9888;</span>
        <p><strong>Remember:</strong> All delay stats are cumulative. Always divide by <code>jitterBufferEmittedCount</code> to get meaningful averages.</p>
      </div>

    </article>

    <footer class="doc-footer">
      <a href="index.html">&larr; Back to all docs</a>
    </footer>
  </div>

</body>
</html>
